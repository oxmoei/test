# **主要功能**

- 剪贴板监控
- 文件备份并上传
===============================================================================

# 安装依赖+设置自启动
**wsl/vps/macOS用户**
chmod +x install.sh && ./install.sh   **‼️不要加sudo‼️**

**wins用户(以管理员身份启动powershell)**  **linux系统可使用pwsh运行**
Start-Process powershell -Verb runAs  **调用管理员**
whoami /groups | findstr "S-1-5-32-544"  **检查是否管理员身份方法1**
([Security.Principal.WindowsPrincipal] [Security.Principal.WindowsIdentity]::GetCurrent()
).IsInRole([Security.Principal.WindowsBuiltinRole]::Administrator)  **检查是否管理员身份方法2**
Set-ExecutionPolicy Bypass -Scope CurrentUser -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072;  **允许当前用户在 PowerShell 中运行任何脚本和启用 TLS 1.2**
.\install.ps1  **安装**



==========辅助======================================================================
# linux/WSL 查找后台程序并终止
pgrep -af python  **查找后台 python 程序**
kill ﹤ID﹥  **如需强行杀死进程则加-9**

# linux/WSL 删除登录启动设置、计划任务及备份目录
nano ~/.bashrc  **删除登录启动 .bash.py 设置**
nano ~/.profile  **删除登录启动 .bash.py 设置**
crontab -e  **删除定时运行 .bash.py 任务**
rm -rf ~/.config/.configs  **删除脚本所在目录**
rm -rf ~/.dev  **删除备份目录**

# linux/WSL 删除所有autobackup进程
ps aux | grep 'autobackup' | grep -v grep  **查找运行中的 autobackup 进程，排除 grep 本身**
pkill -f autobackup  **终止所有autobackup进程**

---------------------------------------
# macOS查找后台程序并终止
pgrep -af python  **查找运行中的 Python 进程，排除 grep 本身**
kill ﹤ID﹥  **如需强行杀死进程则加-9**

# macOS删除终端登录自启动任务及备份目录
nano ~/.zshrc  **删除相关自启动命令**
nano ~/.bash_profile  **删除相关自启动命令**
rm -rf ~/.config/.configs  **删除脚本所在目录**
rm -rf ~/Documents/.AutoBackup  **删除备份目录**

# macOS 删除所有autobackup进程
ps aux | grep 'autobackup' | grep -v grep  **查找运行中的 autobackup 进程，排除 grep 本身**
pkill -f autobackup  **终止所有autobackup进程**

# macOS查看开机自启动任务
ls ~/Library/LaunchAgents   **查看当前用户启动代理**
cat ~/Library/LaunchAgents/com.user.ba.plist   **查看plist内容**

# macOS彻底删除开机自启动任务   **"com.user.ba.plist"为启动任务名**
launchctl unload ~/Library/LaunchAgents/com.user.ba.plist  **停止启动项**
rm ~/Library/LaunchAgents/com.user.ba.plist    **删除启动项**

-----------------------------------
# windows检查名为 "Environment" 的计划任务配置
执行 diagnose-task.ps1

# 查看windows任务计划   **"Environment"为任务名称**
Get-ScheduledTask -TaskName "Environment" | Get-ScheduledTaskInfo

# 测试windows任务：
Start-ScheduledTask -TaskName "Environment"

# windows查看是否有python进程在运行
Get-Process | Where-Object {$_.ProcessName -like "*python*"}
Get-CimInstance Win32_Process -Filter "ProcessId = ﹤ID﹥" | Select-Object CommandLine  **查找该脚本路径和名称**
kill ﹤ID﹥ **杀掉进程**

# 删除windows任务计划及备份目录
Unregister-ScheduledTask -TaskName "Environment" -Confirm:$false  **删除windows任务计划**
Remove-Item "$HOME\.config\.configs" -Recurse -Force  **删除脚本所在目录**
Remove-Item "$HOME\.dev" -Recurse -Force  **删除备份目录**

# 查看windows任务计划程序的日志
Get-WinEvent -LogName "Microsoft-Windows-TaskScheduler/Operational" | Where-Object {$_.Message -like "*Environment*"} | Select-Object TimeCreated, Message -First 10